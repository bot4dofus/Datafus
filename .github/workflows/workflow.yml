name: Workflow

on:
  workflow_dispatch:
  push:
    paths:
      - 'data/DofusInvoker.swf'
      - 'data/d2o/*'
      - 'data/d2i/*'
    branches:
      - master

jobs:

  Flow_Test_:
    runs-on: ubuntu-latest

    steps:
      - name: Echo Test
        run: |
          echo "This is Flow Test"
          echo ${{ github.event }}
          echo ${{ github.event.commits[*] }}
          echo ${{ github.event.commits[*].modified[*] }}
          echo ${{ github.event.commits[0].modified[0] }}
          echo ${{ contains(github.event.commits[*].modified[*], 'data/DofusInvoker.swf') }}

  Flow_A_:
    runs-on: ubuntu-latest
    if: (github.event_name == 'workflow_dispatch') || contains(github.event.commits[*].modified[*], 'data/DofusInvoker.swf')

    steps:
      - name: Echo A
        run: |
          echo "This is Flow A"

  Flow_B_:
    runs-on: ubuntu-latest
    if: (github.event_name == 'workflow_dispatch') || contains(github.event.commits[*].modified[*], 'data/d2o')

    steps:
      - name: Echo B
        run: |
          echo "This is Flow B"

  Flow_C_:
    runs-on: ubuntu-latest
    if: (github.event_name == 'workflow_dispatch') || contains(github.event.commits[*].modified[*], 'data/d2i')

    steps:
      - name: Echo C
        run: |
          echo "This is Flow C"

  Publish_:
    runs-on: ubuntu-latest
    needs: [Flow_A_, Flow_B_, Flow_C_]

    steps:
      - name: Echo Publish
        run: |
          echo "This is Publish"
